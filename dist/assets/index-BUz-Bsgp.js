import{H as j,n as k}from"./navigator-C92a063l.js";import{u as E,r as P,a as _,c as M,d as o,b as g,w as s,e as r,F as R,f as l,o as A,i as C,E as d,H as w,X as H,Y as N}from"./index-3UtpE0ST.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"container"},D={class:"content"},O={__name:"index",setup(z){const m=E();let n=P({stuId:m.stuId,info:null,imageList:[]});function b(t){const e=t.type==="image/jpeg"||"image/png",a=t.size/1024/1024<2;return e?a?!0:(d.error("图片不能超过2MB!"),!1):(d.error("只能上传jepg、png、jpg格式的图片！"),!1)}function h(t,e){d.error("只能上传1张图片！")}let i=null;function x(t,e){i=t,console.log(t)}async function I(t){let e=new FormData;e.append("file",t.raw),await w();let{pictureUrl:a}=await N(e);return a}async function v(){var e,a;await((e=f.value)==null?void 0:e.validate()),await w();let t={stuId:m.stuId,info:n.info,pictureUrl:null};I(i).then(async u=>{t.pictureUrl=u,await H(t),i.status="success"}).catch(u=>{i.status="fail"}),(a=f.value)==null||a.resetFields()}const f=_(),y=_(),L={imageList:[{required:!0,message:"请上传图片！"}],info:[{required:!0,message:"请输入求购信息！",trigger:"blur"}]};return(t,e)=>{const a=l("Plus"),u=l("el-icon"),F=l("el-upload"),p=l("el-form-item"),U=l("el-input"),B=l("el-button"),V=l("el-form");return A(),M(R,null,[o(j),g("div",q,[o(k),g("div",D,[o(V,{model:r(n),"label-width":"auto",rules:L,ref_key:"ruleFormRef",ref:f},{default:s(()=>[o(p,{label:"图片：",prop:"imageList"},{default:s(()=>[o(F,{ref_key:"uploadRef",ref:y,"file-list":r(n).imageList,"onUpdate:fileList":e[0]||(e[0]=c=>r(n).imageList=c),"list-type":"picture-card",limit:1,"auto-upload":!1,"before-upload":b,"on-exceed":h,"on-change":x},{default:s(()=>[o(u,null,{default:s(()=>[o(a)]),_:1})]),_:1},8,["file-list"])]),_:1}),o(p,{label:"求购信息：",prop:"info",style:{width:"400px"}},{default:s(()=>[o(U,{type:"textarea",modelValue:r(n).info,"onUpdate:modelValue":e[1]||(e[1]=c=>r(n).info=c),clearable:"",maxlength:"145","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(p,null,{default:s(()=>[o(B,{type:"success",class:"elButton",onClick:e[2]||(e[2]=c=>v())},{default:s(()=>[C("确认发布")]),_:1})]),_:1})]),_:1},8,["model"])])])],64)}}},Y=S(O,[["__scopeId","data-v-188c4a93"]]);export{Y as default};
